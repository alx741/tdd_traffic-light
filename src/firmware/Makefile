# This Makefile is generated by the made script:
# https://github.com/alx741/made
#
# Replace FILE with your filename
# Replace MMCU with the target chip model
#
# Dependencies:
# 	avr-gcc
# 	avr-binutils


FILE=firmware
MMCU=atmega328p

$(FILE).hex: $(FILE).elf
	avr-objcopy -j .text -j .data -O ihex $< $@

$(FILE).elf: $(FILE).c
	avr-gcc -g -Os -mmcu=$(MMCU) $< -o $@

flash: $(FILE).hex
	sudo avrdude -p m328p -c usbasp -U flash:w:firmware.hex

# Internal 1Mhz oscillator
fuses:
	sudo avrdude -p m328p -c usbasp -U lfuse:w:0x62:m -U hfuse:w:0xd9:m

clean:
	rm $(FILE).elf $(FILE).hex
